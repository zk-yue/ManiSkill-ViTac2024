
Logging to /home/yuezk/yzk/ViTac/ManiSkill-ViTac2024/scripts/../training_log/long_open_lock_2024-03-12_01-55-48.413/SAC_1
/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/stable_baselines3/common/callbacks.py:403: UserWarning: Training and eval env are not of the same type<stable_baselines3.common.vec_env.subproc_vec_env.SubprocVecEnv object at 0x7facf936ddb0> != <stable_baselines3.common.vec_env.dummy_vec_env.DummyVecEnv object at 0x7faba5ecde10>
  warnings.warn("Training and eval env are not of the same type" f"{self.training_env} != {self.eval_env}")
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 10       |
|    fps             | 1        |
|    time_elapsed    | 48       |
|    total_timesteps | 77       |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 20       |
|    fps             | 1        |
|    time_elapsed    | 97       |
|    total_timesteps | 166      |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 30       |
|    fps             | 1        |
|    time_elapsed    | 145      |
|    total_timesteps | 255      |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 40       |
|    fps             | 1        |
|    time_elapsed    | 194      |
|    total_timesteps | 343      |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 50       |
|    fps             | 1        |
|    time_elapsed    | 241      |
|    total_timesteps | 425      |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 60       |
|    fps             | 1        |
|    time_elapsed    | 287      |
|    total_timesteps | 499      |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 70       |
|    fps             | 1        |
|    time_elapsed    | 332      |
|    total_timesteps | 578      |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 80       |
|    fps             | 1        |
|    time_elapsed    | 378      |
|    total_timesteps | 655      |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 90       |
|    fps             | 1        |
|    time_elapsed    | 431      |
|    total_timesteps | 745      |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 100      |
|    fps             | 1        |
|    time_elapsed    | 481      |
|    total_timesteps | 838      |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 110      |
|    fps             | 1        |
|    time_elapsed    | 530      |
|    total_timesteps | 928      |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 120      |
|    fps             | 1        |
|    time_elapsed    | 580      |
|    total_timesteps | 1021     |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 130      |
|    fps             | 1        |
|    time_elapsed    | 629      |
|    total_timesteps | 1099     |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 140      |
|    fps             | 1        |
|    time_elapsed    | 679      |
|    total_timesteps | 1186     |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 150      |
|    fps             | 1        |
|    time_elapsed    | 730      |
|    total_timesteps | 1279     |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 160      |
|    fps             | 1        |
|    time_elapsed    | 783      |
|    total_timesteps | 1365     |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 170      |
|    fps             | 1        |
|    time_elapsed    | 832      |
|    total_timesteps | 1447     |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 180      |
|    fps             | 1        |
|    time_elapsed    | 880      |
|    total_timesteps | 1531     |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 190      |
|    fps             | 1        |
|    time_elapsed    | 929      |
|    total_timesteps | 1619     |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 200      |
|    fps             | 1        |
|    time_elapsed    | 978      |
|    total_timesteps | 1704     |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 210      |
|    fps             | 1        |
|    time_elapsed    | 1031     |
|    total_timesteps | 1796     |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 220      |
|    fps             | 1        |
|    time_elapsed    | 1077     |
|    total_timesteps | 1875     |
---------------------------------
---------------------------------
| rollout/           |          |
|    success_rate    | 0        |
| time/              |          |
|    episodes        | 230      |
|    fps             | 1        |
|    time_elapsed    | 1122     |
|    total_timesteps | 1954     |
---------------------------------
/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/stable_baselines3/common/evaluation.py:67: UserWarning: Evaluation environment is not wrapped with a ``Monitor`` wrapper. This may result in reporting modified episode lengths and rewards, if other wrappers happen to modify these. Consider wrapping environment first with ``Monitor`` wrapper.
  warnings.warn(
/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py:181: DeprecationWarning: [33mWARN: Current gymnasium version requires that `Env.reset` can be passed `options` to allow the environment initialisation to be passed additional information.
  logger.deprecation(
index= 2 keyoffset= (47.84210906075512, 0.0, -0.0)
Traceback (most recent call last):
  File "/home/yuezk/yzk/ViTac/ManiSkill-ViTac2024/scripts/train_sac.py", line 178, in <module>
    model.learn(
  File "/home/yuezk/yzk/ViTac/ManiSkill-ViTac2024/scripts/../solutions/sac_custom.py", line 307, in learn
    return super().learn(
  File "/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/stable_baselines3/common/off_policy_algorithm.py", line 312, in learn
    rollout = self.collect_rollouts(
  File "/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/stable_baselines3/common/off_policy_algorithm.py", line 552, in collect_rollouts
    if callback.on_step() is False:
  File "/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/stable_baselines3/common/callbacks.py", line 104, in on_step
    return self._on_step()
  File "/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/stable_baselines3/common/callbacks.py", line 208, in _on_step
    continue_training = callback.on_step() and continue_training
  File "/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/stable_baselines3/common/callbacks.py", line 104, in on_step
    return self._on_step()
  File "/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/stable_baselines3/common/callbacks.py", line 449, in _on_step
    episode_rewards, episode_lengths = evaluate_policy(
  File "/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/stable_baselines3/common/evaluation.py", line 88, in evaluate_policy
    actions, states = model.predict(
  File "/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/stable_baselines3/common/base_class.py", line 555, in predict
    return self.policy.predict(observation, state, episode_start, deterministic)
  File "/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 349, in predict
    actions = self._predict(observation, deterministic=deterministic)
  File "/home/yuezk/yzk/ViTac/ManiSkill-ViTac2024/scripts/../solutions/sb3_sac_policies.py", line 353, in _predict
    return self.actor(observation, deterministic)
  File "/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yuezk/yzk/ViTac/ManiSkill-ViTac2024/scripts/../solutions/sb3_sac_policies.py", line 168, in forward
    mean_actions, log_std, kwargs = self.get_action_dist_params(obs)
  File "/home/yuezk/yzk/ViTac/ManiSkill-ViTac2024/scripts/../solutions/sb3_sac_policies.py", line 155, in get_action_dist_params
    features = self.extract_features(obs, self.features_extractor)
  File "/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 130, in extract_features
    preprocessed_obs = preprocess_obs(obs, self.observation_space, normalize_images=self.normalize_images)
  File "/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/stable_baselines3/common/preprocessing.py", line 135, in preprocess_obs
    preprocessed_obs[key] = preprocess_obs(_obs, observation_space[key], normalize_images=normalize_images)
  File "/home/yuezk/anaconda3/envs/mani_vitac/lib/python3.10/site-packages/stable_baselines3/common/preprocessing.py", line 111, in preprocess_obs
    return obs.float()
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 7.73 GiB total capacity; 2.92 MiB already allocated; 16.06 MiB free; 4.00 MiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[34mINFO - Step = 0, time = 0.0000 (ipc_system.py:491)
[34mINFO - Newton iteration did not converge after 5 iterations, p_inf = 3.8898e-07 (ipc_system.py:610)
[34mINFO - Step = 1, time = 0.2000 (ipc_system.py:491)
[34mINFO - Newton iteration did not converge after 5 iterations, p_inf = 9.1745e-04 (ipc_system.py:610)
[34mINFO - Step = 2, time = 0.4000 (ipc_system.py:491)
[34mINFO - Newton iteration did not converge after 5 iterations, p_inf = 5.2648e-04 (ipc_system.py:610)
[34mINFO - Entity "tactile_sensor_1" has IPC component but no render component (user_utils.py:72)
[34mINFO - Entity "tactile_sensor_2" has IPC component but no render component (user_utils.py:72)
[34mINFO - Entity "tactile_sensor_1" has IPC component but no render component (user_utils.py:72)
[34mINFO - Entity "tactile_sensor_2" has IPC component but no render component (user_utils.py:72)